<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/css/datepicker3.min.css" />
<div class="portlet box green" >
    <div class="portlet-title">
        <div class="caption">
            @*Assignment Contract Agreement*@ Agreement Details
        </div>
        <div class="tools">
            <a href="javascript:void(0);" class="collapse" data-original-title="" title=""> </a>
        </div>
    </div>
    <div class="portlet-body clearfix">
        <div class="row" ng-show="!AgreementStatus && ('@ViewBag.Department' == 'ad' || '@ViewBag.Department' == 'sa')">
            <div class="col-md-12">
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="control-label col-md-5">Update without Agreement</label>
                            <div class="col-md-7">
                                <div class="form-group">
                                    <label class="radio-inline">
                                        <input type="checkbox" ng-model="chk_AgreementYesorNo" id="chk_AgreementYesorNo" name="chk_AgreementYesorNo" />
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row" ng-show="!chk_AgreementYesorNo">
            <div class="col-md-12">
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="control-label col-md-5">Contract status <span class="red">*</span></label>
                            <div class="col-md-7">
                                <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.AgreementStatus.$dirty) && userForm.AgreementStatus.$invalid } ">
                                    <label class="radio-inline">
                                        <input type="radio" name="AgreementStatus" ng-model="AgreementStatus" value="Draft" required> Draft
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="AgreementStatus" ng-model="AgreementStatus" value="Pending" required> Issued
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="AgreementStatus" ng-model="AgreementStatus" value="Issued" required> Received
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="AgreementStatus" ng-model="AgreementStatus" value="Cancelled" required> Cancelled
                                    </label>
                                    <div class="help-block">
                                        <p ng-show="userForm.AgreementStatus.$error.required && (userForm.AgreementStatus.$dirty || submitted)">Please select Contract Status </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel" ng-show="AgreementStatus!='Cancelled' && AgreementStatus!='Draft' && AgreementStatus!=''">
                            <div class="col-md-12" ng-show="AgreementStatus=='Issued'">
                                <label class="control-label col-md-5">Date of Agreement<span class="red">*</span></label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.AgreementDate.$dirty) && userForm.AgreementDate.$invalid } ">
                                        <div class="input-group datePickerUpdate input-append date" id="AgreementDate">
                                            <input type="text" class="form-control datepickerupdate" onchange="FillAgreementDate($(this))" ng-required="AgreementStatus=='Issued'" placeholder="Please enter agreement date"
                                                   name="AgreementDate" id="AgreementDateid" ng-model="AgreementDate">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>
                                        <div class="help-block">
                                            <p ng-show="userForm.AgreementDate.$error.required && (userForm.AgreementDate.$dirty || submitted)">Please enter agreement date</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" ng-show="AgreementStatus=='Issued' && TemsOfCopyRight==1">
                                <label class="control-label col-md-5">Effective Date</label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.EffectiveDate.$dirty) &amp;&amp; userForm.EffectiveDate.$invalid } ">
                                        <div class="input-group input-append datePickerUpdate date" id="EffectiveDate">
                                            <input type="text" class="form-control datePickerUpdate" ng-required="false"
                                                   name="EffectiveDate" id="EffectiveDate" placeholder="Please enter effective date" ng-model="EffectiveDate" required>
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>
                                        <div class="help-block">
                                            <p ng-show="userForm.EffectiveDate.$error.required && (userForm.EffectiveDate.$dirty || submitted)">Please enter effective date</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @*<div class="col-md-12" ng-show="AgreementStatus=='Issued' && TemsOfCopyRight==1">
                                <label class="control-label col-md-5">Period of Agreement (In Month) <span class="red">*</span></label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.PeriodOfAgreementAgreement.$dirty) && userForm.PeriodOfAgreementAgreement.$invalid } ">

                                        <input type="number" name="PeriodOfAgreementAgreement" min="0" ng-change="CalculateExpiryAgreement(PeriodOfAgreement)" class="form-control" ng-model="PeriodOfAgreement"
                                               ng-required="TemsOfCopyRight==1 && AgreementStatus=='Issued'" placeholder="Enter period of agreement">
                                        <div class="help-block">
                                            <p ng-show="userForm.PeriodOfAgreementAgreement.$error.required && (userForm.PeriodOfAgreementAgreement.$dirty || submitted)">Please select period of agreement </p>
                                        </div>
                                    </div>
                                </div>
                            </div>*@
                            <div class="col-md-12" ng-show="AgreementStatus=='Issued' && TemsOfCopyRight==1">
                                <label class="control-label col-md-5">Expiry Date<span class="red">*</span></label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.ExpiryDate.$dirty) && userForm.ExpiryDate.$invalid } ">
                                        @*<input type="datetime" name="ExpiryDate" id="ExpiryDate" readonly class="form-control" ng-model="ExpiryDate" placeholder="Enter expiry date">*@
                                        <div class="input-group datePickerUpdate input-append date ExpiryDate" id="ExpiryDate">
                                            <input type="text" name="ExpiryDate" id="ExpiryDate" class="form-control" ng-model="ExpiryDate" placeholder="Please enter expiry date"
                                                   ng-required="TemsOfCopyRight==1 && AgreementStatus=='Issued'" onchange="FillExpiryDate($(this))">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>
                                        <div class="help-block">
                                            <p ng-show="userForm.ExpiryDate.$error.required && (userForm.ExpiryDate.$dirty || submitted)">Please enter expiry date</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12" ng-show="AgreementStatus=='Issued'">
                                <label class="control-label col-md-5">Signed Contract received date</label>
                                <div class="col-md-7">
                                    <div class="form-group">
                                        <div class="input-group datePickerUpdate input-append date contractRecieved" id="contractRecieved">
                                            <input type="text" class="form-control" placeholder="Enter Signed Contract received date"
                                                   name="contractRecieved" id="contractRecieved" ng-model="contractRecieved">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>

                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12" ng-show="AgreementStatus=='Issued'">
                                <label class=" control-label col-md-5">
                                    Signed Contract sent date
                                </label>
                                <div class="col-md-7">
                                    <div class="form-group">
                                        <div class="input-group datePickerUpdate input-append date SignedcontracDate" id="SignedcontracDate">
                                            <input type="text" class="form-control" placeholder="Please enter Signed Contract sent date"
                                                   name="SignedcontracDate" id="SignedcontracDate" ng-model="SignedcontracDate">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            @*<div class="col-md-12" ng-show="AgreementStatus=='Issued'">
                                <label class="control-label col-md-5">Author copies sent date </label>
                                <div class="col-md-7">
                                    <div class="form-group ">
                                        <div class="input-group datePickerUpdate input-append date AuthorCopiesSend" id="AuthorCopiesSend">
                                            <input type="text" class="form-control" placeholder="Enter Author copies sent date"
                                                   name="AuthorCopiesSend" id="AuthorCopiesSend" ng-model="AuthorCopiesSend">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>

                                        </div>

                                    </div>
                                </div>
                            </div>*@

                            @*<div class="col-md-12" ng-show="AgreementStatus=='Issued'">
                                <label class="control-label col-md-5">Contributor copies sent date </label>
                                <div class="col-md-7">
                                    <div class="form-group">
                                        <div class="input-group datePickerUpdate input-append date CotributorCopiessend" id="CotributorCopiessend">
                                            <input type="text" class="form-control" placeholder="Enter Contributor copies sent date"
                                                   name="CotributorCopiessend" id="CotributorCopiessend" ng-model="CotributorCopiessend">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>

                                    </div>
                                </div>
                            </div>*@

                            <div class="col-md-12">

                                <label class="control-label col-md-5"> Remarks <span ng-if="AgreementStatus=='Pending'" class="red">*</span></label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.ContractRemarks.$dirty) && userForm.ContractRemarks.$invalid } ">
                                        <textarea name="ContractRemarks" class="form-control" ng-model="ContractRemarks"
                                                  placeholder="Please enter remarks" ng-required="AgreementStatus=='Pending'"></textarea>

                                        <div class="help-block">
                                            <p ng-show="userForm.ContractRemarks.$error.required && (userForm.ContractRemarks.$dirty || submitted)">Please enter remarks</p>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="panel1" ng-show="AgreementStatus=='Cancelled' || AgreementStatus =='Draft'">
                            <div class="col-md-12">
                                <label class="control-label col-md-5"><span ng-bind="AgreementStatus =='Draft' ? 'Draft Date' : 'Cancellation date'"></span><span class="red">*</span></label>
                                <div class="col-md-7">

                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.CancelDate.$dirty) && userForm.CancelDate.$invalid } ">
                                        <div class="input-group datePickerUpdate input-append date CancelDate" id="CancelDate">
                                            <input type="text" class="form-control"
                                                   placeholder="{{AgreementStatus =='Draft' ? 'Enter Draft Date' : 'Enter Cancellation Date'}}"
                                                   name="CancelDate" id="CancelDate" ng-model="CancelDate">
                                            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>
                                        <div class="help-block">
                                            <p ng-show="userForm.CancelDate.$error.required && (userForm.CancelDate.$dirty || submitted)">Enter <span ng-bind="AgreementStatus =='Draft' ? 'Draft Date' : 'Cancellation date'"></span></p>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-12">
                                <label class="control-label col-md-5"><span ng-bind="AgreementStatus =='Draft' ? 'Draft Remarks' : 'Cancellation Reason'"></span><span class="red">*</span></label>
                                <div class="col-md-7">
                                    <div class="form-group" ng-class="{ 'has-error': ( submitted ||userForm.CancellationRemarks.$dirty) && userForm.CancellationRemarks.$invalid } ">
                                        <textarea name="CancellationRemarks" class="form-control" ng-model="CancellationRemarks"
                                                  placeholder="{{AgreementStatus =='Draft' ? 'Draft Remarks' : 'Cancellation Reason'}}"></textarea>
                                        <div class="help-block">
                                            <p ng-show="userForm.CancellationRemarks.$error.required && (userForm.CancellationRemarks.$dirty || submitted)">Enter <span ng-bind="AgreementStatus =='Draft' ? 'Draft Remarks' : 'Cancellation Reason'"></span></p>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="panel" ng-show="AgreementStatus!='Cancelled' && AgreementStatus!='Draft' && AgreementStatus!=''">

                            <div class="col-md-12" id="Uploadfiles">
                                <label class="control-label col-md-12 "> Upload Contract</label>
                                <div class="col-md-12 form-group uploadFileMutple" style="margin-left: 10px;" id="contractDoc">
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div class="panel-body" ng-if="AgreementDoc.length>0">
                            <table class="table table-striped table-hover ">
                                <thead>
                                    <tr>
                                        <th>S.No</th>
                                        <th>Document Name</th>
                                        <th ng-if="'@ViewBag.Department'=='ad' || '@ViewBag.Department'=='sa'">Action</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="url in AgreementDoc">
                                        <td><span ng-bind="$index + 1"></span> <input type="hidden" name="DocId_{{$index}}" value="{{url.Id}}" /></td>
                                        <td><a href="~/uploads/{{url.FileName}}" download="{{url.FileName}}" target="_blank" style="color: black;"><span ng-bind="url.FileNameEntered"></span> </a></td>
                                        <td ng-if="'@ViewBag.Department'=='ad' || '@ViewBag.Department'=='sa'"><a style=" color: black; cursor:pointer;" ng-click="RemoveDocument(url.Id,url.FileName)">Delete</a></td> @*ng-click="RemoveDocumentLinkById(url.Id,url.FileNameEntered)"*@
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="control-label col-md-5">Contributor Agreement <span class="red">*</span></label>
                            <div class="col-md-7">
                                <div class="form-group" ng-class="{ 'has-error': (submitted ||userForm.ContributorAgreement.$dirty) && userForm.ContributorAgreement.$invalid } ">
                                    <label class="radio-inline">
                                        <input type="radio" name="ContributorAgreement" ng-model="ContributorAgreement" value="Yes" required> Yes
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="ContributorAgreement" ng-model="ContributorAgreement" value="No" required> No
                                    </label>
                                    <div class="help-block">
                                        <p ng-show="userForm.ContributorAgreement.$error.required && (userForm.ContributorAgreement.$dirty || submitted)">Please select Contributor Agreement </p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12" id="Uploadfiles" ng-show="ContributorAgreement!='No' && ContributorAgreement!=''">

                            <label class="control-label col-md-12 "> Upload Contributor Document<span class="red">*</span></label>
                            <div class="col-md-12 form-group uploadFileMutple" style="margin-left: 10px; " id="ContributorDoc">
                            </div>
                            <div class="clearfix"></div>


                        </div>

                    </div>

                    <div class="panel-body" ng-if="ContributorDoc.length>0">
                        <table class="table table-striped table-hover ">
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th>Document Name</th>
                                    <th ng-if="'@ViewBag.Department'=='ad' || '@ViewBag.Department'=='sa'">Action</th>

                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="url in ContributorDoc">
                                    <td><span ng-bind="$index + 1"></span> <input type="hidden" name="DocId_{{$index}}" value="{{url.Id}}" /></td>
                                    <td><a href="~/uploads/{{url.FileName}}" download="{{url.FileName}}" target="_blank" style="color: black;"><span ng-bind="url.FileNameEntered"></span></a></td>
                                    <td ng-if="'@ViewBag.Department'=='ad' || '@ViewBag.Department'=='sa'"><a style=" color: black; cursor:pointer;" ng-click="RemoveDocument(url.Id,url.FileName)">Delete</a></td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
        </div>
     </div>
</div>
<script type="text/javascript">


    function renderFileUpload() {
        $.ajax({
            cache: false,
            type: "GET",
            contentType: 'application/html; charset=utf-8',
            url: GlobalredirectPath + "/Master/Master/MultipleFileUpload",
            data: {},
            datatype: 'html',
            success: function (result) {
                $(".uploadFileMutple").html(result);

            },
            error: function (xhr, ajaxOptions, thrownError) {

            }
        });

    }
    $(document).ready(function () {
        renderFileUpload();
        $('.datePickerUpdate').datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            onSelect: function () {
                RemoveValidation($(this).find('input'));
            }

        });
        

    });
    //function FillEffectiveDate(obj) { FillAgreementDate
       
    //    $("input[id*=EffectiveDate]").val($(obj).val());
    //    if ($(obj).val() != "")
    //    {
    //        $(obj).closest(".form-group").removeClass("has-error");
    //        $(obj).closest(".form-group").find(".help-block").find("p").addClass("ng-hide").removeClass("ng-show");
    //     }
    //    else {
    //        $(obj).closest(".form-group").addClass("has-error");
    //        $(obj).closest(".form-group").find(".help-block").find("p").removeClass("ng-hide").addClass("ng-show");
    //    }

    //    //angular.element(document.getElementById('angularid')).scope().CalculateExpiryAgreement($("input[name*=PeriodOfAgreementAgreement]").val() == "" ? undefined : $("input[name*=PeriodOfAgreementAgreement]").val());
    //}

    function FillAgreementDate(obj) {

        $("input[id*=AgreementDate]").val($(obj).val());
        if ($(obj).val() != "")
        {
            $(obj).closest(".form-group").removeClass("has-error");
            $(obj).closest(".form-group").find(".help-block").find("p").addClass("ng-hide").removeClass("ng-show");
         }
        else {
            $(obj).closest(".form-group").addClass("has-error");
            $(obj).closest(".form-group").find(".help-block").find("p").removeClass("ng-hide").addClass("ng-show");
        }
    }

    function FillExpiryDate(obj) {

        $("input[id*=ExpiryDate]").val($(obj).val());
        if ($(obj).val() != "") {
            $(obj).closest(".form-group").removeClass("has-error");
            $(obj).closest(".form-group").find(".help-block").find("p").addClass("ng-hide").removeClass("ng-show");
        }
        else {
            $(obj).closest(".form-group").addClass("has-error");
            $(obj).closest(".form-group").find(".help-block").find("p").removeClass("ng-hide").addClass("ng-show");
        }
    }
</script>
